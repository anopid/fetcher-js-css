function getXHR(){
    try {
        return new XMLHttpRequest();
    } catch (e) {
        try {
            return new ActiveXObject('MSXML2.XMLHTTP.6.0');
        } catch (e) {
            try {
                return new ActiveXObject('MSXML2.XMLHTTP.3.0');
            } catch (e) {
                return null;
            }
        }
    }


}
var loadCSS =function(url, callback) {
    script1 =  document.createElement('style');
    script1.type = "text/css";
    script1.async =true;

    var client = getXHR();
    client.open('GET', url, true);
    client.onload  = function() {
        script1.appendChild(document.createTextNode(client.responseText));
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(script1);
        if (callback && typeof callback === "function") {
            callback();
        }
    }
    client.send();
}

var loadScript = function(url, callback) {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.async = true;
    if (script.readyState) {
        script.onreadystatechange = function () {
            if (script.readyState == "loaded" || script.readyState == "complete") {
                script.onreadystatechange = null;
                if (callback && typeof callback === "function") {
                    callback();
                }
            }
        };
    } else {
        script.onload = function () {
            if (callback && typeof callback === "function") {
                callback();
            }
        };
    }
    script.src = url;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(script);
}
module.exports = {
    loadScript: loadScript,
    loadCSS: loadCSS
}